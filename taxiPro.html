
!DOCTYPE html
html lang=ja
head
    meta charset=UTF-8
    meta name=viewport content=width=device-width, initial-scale=1.0
    titleMAGIã‚¿ã‚¯ã‚·ãƒ¼å£²ä¸Šç®¡ç†title
    script src=httpscdn.tailwindcss.comscript
    script src=httpscdn.jsdelivr.netnpmchart.jsscript
head
body class=bg-gray-100 min-h-screen
    div class=container mx-auto px-4 py-8 max-w-6xl
        h1 class=text-3xl font-bold text-center mb-8 text-gray-800ğŸš• MAGIã‚¿ã‚¯ã‚·ãƒ¼å£²ä¸Šç®¡ç†ã‚·ã‚¹ãƒ†ãƒ h1
        
        !-- ä»Šæ—¥ã®æ¦‚è¦ã‚«ãƒ¼ãƒ‰ --
        div class=bg-white rounded-lg shadow-md p-6 mb-6
            h2 class=text-xl font-semibold mb-4 text-gray-700ä»Šæ—¥ã®çŠ¶æ³h2
            div class=grid grid-cols-1 mdgrid-cols-4 gap-4
                div class=bg-blue-50 p-4 rounded-lg
                    p class=text-sm text-gray-600ç›®æ¨™å£²ä¸Šp
                    p class=text-2xl font-bold text-blue-600 id=targetAmountÂ¥50,000p
                div
                div class=bg-green-50 p-4 rounded-lg
                    p class=text-sm text-gray-600ç¾åœ¨ã®å£²ä¸Šp
                    p class=text-2xl font-bold text-green-600 id=currentRevenueÂ¥0p
                div
                div class=bg-orange-50 p-4 rounded-lg
                    p class=text-sm text-gray-600é”æˆç‡p
                    p class=text-2xl font-bold text-orange-600 id=achievementRate0%p
                div
                div class=bg-purple-50 p-4 rounded-lg
                    p class=text-sm text-gray-600ãƒ­ãƒ³ã‚°å®¢æ•°p
                    p class=text-2xl font-bold text-purple-600 id=longCustomerCount0ä»¶p
                div
            div
        div

        !-- å£²ä¸Šå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  --
        div class=bg-white rounded-lg shadow-md p-6 mb-6
            h2 class=text-xl font-semibold mb-4 text-gray-700å£²ä¸Šã‚’è¨˜éŒ²h2
            form id=revenueForm class=space-y-4
                div class=grid grid-cols-1 mdgrid-cols-3 gap-4
                    div
                        label class=block text-sm font-medium text-gray-700 mb-1æ™‚é–“label
                        input type=time id=time class=w-full px-3 py-2 border border-gray-300 rounded-md focusoutline-none focusring-2 focusring-blue-500 required
                    div
                    div
                        label class=block text-sm font-medium text-gray-700 mb-1å£²ä¸Šé‡‘é¡label
                        input type=number id=amount class=w-full px-3 py-2 border border-gray-300 rounded-md focusoutline-none focusring-2 focusring-blue-500 placeholder=ä¾‹ 2500 required
                    div
                    div
                        label class=block text-sm font-medium text-gray-700 mb-1æ›œæ—¥label
                        select id=dayOfWeek class=w-full px-3 py-2 border border-gray-300 rounded-md focusoutline-none focusring-2 focusring-blue-500
                            option value=æœˆæœˆæ›œæ—¥option
                            option value=ç«ç«æ›œæ—¥option
                            option value=æ°´æ°´æ›œæ—¥option
                            option value=æœ¨æœ¨æ›œæ—¥option
                            option value=é‡‘é‡‘æ›œæ—¥option
                            option value=åœŸåœŸæ›œæ—¥option
                            option value=æ—¥æ—¥æ›œæ—¥option
                        select
                    div
                div
                
                !-- ãƒ­ãƒ³ã‚°å®¢ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ --
                div class=flex items-center mb-4
                    input type=checkbox id=isLongCustomer class=mr-2 h-4 w-4 text-blue-600 focusring-blue-500 border-gray-300 rounded
                    label for=isLongCustomer class=text-sm font-medium text-gray-700ãƒ­ãƒ³ã‚°å®¢ï¼ˆé•·è·é›¢ä¹—å®¢ï¼‰label
                div

                !-- ãƒ­ãƒ³ã‚°å®¢è©³ç´°ï¼ˆæ¡ä»¶ä»˜ãè¡¨ç¤ºï¼‰ --
                div id=longCustomerDetails class=hidden space-y-4 p-4 bg-purple-50 rounded-lg
                    h3 class=font-medium text-purple-800ãƒ­ãƒ³ã‚°å®¢æƒ…å ±h3
                    div class=grid grid-cols-1 mdgrid-cols-2 gap-4
                        div
                            label class=block text-sm font-medium text-gray-700 mb-1ä¹—è»Šå ´æ‰€label
                            input type=text id=pickupLocation class=w-full px-3 py-2 border border-gray-300 rounded-md focusoutline-none focusring-2 focusring-purple-500 placeholder=ä¾‹ é§…å‰ã€ç©ºæ¸¯ã€ãƒ›ãƒ†ãƒ«
                        div
                        div
                            label class=block text-sm font-medium text-gray-700 mb-1é™è»Šå ´æ‰€label
                            input type=text id=dropoffLocation class=w-full px-3 py-2 border border-gray-300 rounded-md focusoutline-none focusring-2 focusring-purple-500 placeholder=ä¾‹ å¸‚å†…ã€éš£ç”ºã€è¦³å…‰åœ°
                        div
                    div
                    div
                        label class=block text-sm font-medium text-gray-700 mb-1å®¢å±¤ãƒ»ç‰¹å¾´label
                        input type=text id=customerType class=w-full px-3 py-2 border border-gray-300 rounded-md focusoutline-none focusring-2 focusring-purple-500 placeholder=ä¾‹ ãƒ“ã‚¸ãƒã‚¹ãƒãƒ³ã€è¦³å…‰å®¢ã€å®¶æ—é€£ã‚Œ
                    div
                    div
                        label class=block text-sm font-medium text-gray-700 mb-1è·é›¢ï¼ˆkmï¼‰label
                        input type=number id=distance class=w-full px-3 py-2 border border-gray-300 rounded-md focusoutline-none focusring-2 focusring-purple-500 placeholder=ä¾‹ 25
                    div
                div

                div
                    label class=block text-sm font-medium text-gray-700 mb-1ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰label
                    input type=text id=memo class=w-full px-3 py-2 border border-gray-300 rounded-md focusoutline-none focusring-2 focusring-blue-500 placeholder=ä¾‹ ç©ºæ¸¯é€è¿ã€è¦³å…‰å®¢ãªã©
                div
                button type=submit class=w-full bg-blue-600 text-white py-2 px-4 rounded-md hoverbg-blue-700 transition duration-200 font-medium
                    å£²ä¸Šã‚’è¨˜éŒ²ã—ã¦MAGIåˆ†æã‚’å—ã‘ã‚‹
                button
            form
        div

        !-- MAGIåˆ†æçµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ --
        div id=magiAnalysis class=hidden bg-white rounded-lg shadow-md p-6 mb-6
            h2 class=text-xl font-semibold mb-4 text-gray-700ğŸ§  MAGIåˆ†æçµæœh2
            div id=magiResults class=space-y-4 text-smdiv
        div

        !-- ãƒ­ãƒ³ã‚°å®¢è¨˜éŒ²ä¸€è¦§ --
        div class=bg-white rounded-lg shadow-md p-6 mb-6
            h2 class=text-xl font-semibold mb-4 text-gray-700ğŸ¯ ãƒ­ãƒ³ã‚°å®¢è¨˜éŒ²h2
            div id=longCustomerList class=space-y-2
                p class=text-gray-500 text-center py-4ãƒ­ãƒ³ã‚°å®¢ã®è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“p
            div
        div

        !-- å£²ä¸Šä¸€è¦§ --
        div class=bg-white rounded-lg shadow-md p-6 mb-6
            h2 class=text-xl font-semibold mb-4 text-gray-700ä»Šæ—¥ã®å£²ä¸Šä¸€è¦§h2
            div id=revenueList class=space-y-2
                p class=text-gray-500 text-center py-4å£²ä¸Šãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“p
            div
        div

        !-- é€±é–“ã‚°ãƒ©ãƒ• --
        div class=bg-white rounded-lg shadow-md p-6
            h2 class=text-xl font-semibold mb-4 text-gray-700é€±é–“å£²ä¸Šæ¨ç§»h2
            canvas id=weeklyChart width=400 height=200canvas
        div

        !-- ãƒ‡ãƒ¼ã‚¿æ“ä½œãƒœã‚¿ãƒ³ --
        div class=mt-6 flex gap-4 justify-center
            button onclick=exportData() class=bg-gray-600 text-white py-2 px-4 rounded-md hoverbg-gray-700 transition duration-200
                ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
            button
            button onclick=clearData() class=bg-red-600 text-white py-2 px-4 rounded-md hoverbg-red-700 transition duration-200
                ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢
            button
        div
    div

    script
         ãƒ‡ãƒ¼ã‚¿ç®¡ç†
        let revenueData = JSON.parse(localStorage.getItem('taxiRevenue'))  [];
        let longCustomerData = JSON.parse(localStorage.getItem('longCustomerData'))  [];
        let targetAmount = parseInt(localStorage.getItem('targetAmount'))  50000;

         åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
             ç¾åœ¨æ™‚åˆ»ã‚’è¨­å®š
            const now = new Date();
            document.getElementById('time').value = now.toTimeString().slice(0, 5);
            
             æ›œæ—¥ã‚’è¨­å®š
            const days = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
            document.getElementById('dayOfWeek').value = days[now.getDay()];
            
            updateDisplay();
            updateChart();
            document.getElementById('targetInput').value = targetAmount;
        });

         ãƒ­ãƒ³ã‚°å®¢ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
        document.getElementById('isLongCustomer').addEventListener('change', function() {
            const details = document.getElementById('longCustomerDetails');
            if (this.checked) {
                details.classList.remove('hidden');
            } else {
                details.classList.add('hidden');
            }
        });

         MAGIåˆ†æé–¢æ•°
        function performMAGiAnalysis(revenueRecord, todayTotal, target, longCustomers) {
            const achievementRate = (todayTotal  target)  100;
            const currentTime = revenueRecord.time;
            const dayOfWeek = revenueRecord.dayOfWeek;
            
            let analysis = {
                logic ,
                moral ,
                desire ,
                future ,
                critic ,
                create ,
                empathy ,
                realist ,
                care ,
                rebel ,
                meta ,
                conclusion 
            };

             MAGI-1 (LOGIC) è«–ç†ãƒ»åŠ¹ç‡åˆ†æ
            if (achievementRate = 100) {
                analysis.logic = ç›®æ¨™é”æˆæ¸ˆã¿ã€‚ç¾åœ¨æ™‚åˆ»${currentTime}ã§${achievementRate.toFixed(1)}%é”æˆã€‚åŠ¹ç‡çš„ãªå–¶æ¥­ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¶­æŒã—ã€è¿½åŠ åå…¥ã‚’æœ€å¤§åŒ–ã™ã¹ãã€‚;
            } else if (achievementRate = 80) {
                analysis.logic = ç›®æ¨™é”æˆã«è¿‘ã„ã€‚æ®‹ã‚Š${(target - todayTotal).toLocaleString()}å††å¿…è¦ã€‚å¹³å‡å˜ä¾¡2,500å††ãªã‚‰ã‚ã¨${Math.ceil((target - todayTotal)  2500)}ä»¶ç¨‹åº¦ã€‚åŠ¹ç‡çš„ãªã‚¨ãƒªã‚¢ç§»å‹•ã‚’ã€‚;
            } else if (achievementRate = 50) {
                analysis.logic = ç›®æ¨™ã®åŠåˆ†ç¨‹åº¦ã€‚æ™‚é–“å¸¯ã¨æ›œæ—¥${dayOfWeek}ã‚’è€ƒæ…®ã—ã€å•†æ¥­æ–½è¨­ã‚„ç¹è¯è¡—ã¸ç§»å‹•ã‚’æ¨å¥¨ã€‚æ®‹ã‚Š${(target - todayTotal).toLocaleString()}å††ã€‚;
            } else {
                analysis.logic = ç›®æ¨™é”æˆã¾ã§å¤§å¹…ã«ä¸è¶³ã€‚æˆ¦ç•¥çš„ãªè¦‹ç›´ã—ãŒå¿…è¦ã€‚ç©ºæ¸¯è·¯ç·šã‚„ãƒ›ãƒ†ãƒ«å‘¨è¾ºã€ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ãªã©é«˜å˜ä¾¡ã‚¨ãƒªã‚¢ã‚’æ¤œè¨ã€‚;
            }

             MAGI-2 (MORAL) ä¿å®ˆãƒ»é“å¾³
            analysis.moral = å®‰å…¨é‹è»¢ã‚’æœ€å„ªå…ˆã«ã€‚ç„¡ç†ãªå–¶ã¿ã¯ç¦ç‰©ã€‚ç–²åŠ´å›°æ†ŠçŠ¶æ…‹ã§ã®é‹è»¢ã¯é¡§å®¢ã«ã‚‚å±é™ºã€‚å¿…è¦ãªã‚‰ä¼‘æ†©ã‚’ã€‚;

             MAGI-3 (DESIRE) ç›´æ„Ÿãƒ»æ¬²æœ›
            if (longCustomers.length  0) {
                analysis.desire = ãƒ­ãƒ³ã‚°å®¢ç²å¾—ã®æ‰‹å¿œãˆã‚ã‚Šã€‚é‹ãŒå‘ã„ã¦ãã¦ã„ã‚‹ã€‚å‹¢ã„ã«ä¹—ã‚Œã€‚ç©æ¥µçš„ã«é«˜å˜ä¾¡ã‚¨ãƒªã‚¢ã¸ã€‚;
            } else {
                analysis.desire = ãƒ“ãƒƒã‚°ã‚²ãƒ¼ãƒ ã‚’ç‹™ãˆã€‚ç©ºæ¸¯ã€è¦³å…‰åœ°ã€é«˜ç´šãƒ›ãƒ†ãƒ«ã€‚ä¸€ç™ºå¤§é€†è»¢ã®å¯èƒ½æ€§ã‚’ä¿¡ã˜ã¦ã€‚;
            }

             MAGI-4 (FUTURE) é•·æœŸæˆ¦ç•¥
            analysis.future = ä»Šæ—¥ã®ãƒ‡ãƒ¼ã‚¿ã¯æ¥é€±ã®åŒã˜æ›œæ—¥ã®å‚è€ƒã«ãªã‚‹ã€‚${dayOfWeek}æ›œæ—¥ã®æˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¢ºç«‹ã—ã€é€±æ¬¡æˆ¦ç•¥ã«çµ„ã¿è¾¼ã‚€ã€‚;

             MAGI-5 (CRITIC) æ‰¹è©•ãƒ»æ‡ç–‘
            analysis.critic = ç¾åœ¨åœ°ã‚„æ™‚é–“å¸¯ã«ã‚ˆã‚‹ç©ºè»Šç‡ã®å¤‰å‹•ã‚’è€ƒæ…®ã€‚å˜ã«é‡‘é¡ã ã‘ã§ãªãã€åŠ¹ç‡ï¼ˆå††æ™‚é–“ï¼‰ã‚‚æ¸¬å®šã™ã¹ãã€‚;

             MAGI-6 (CREATE) å‰µé€ ãƒ»å®Ÿé¨“
            analysis.create = æ–°è¦é¡§å®¢å±¤é–‹æ‹“ã‚’ææ¡ˆã€‚SNSã§ã®æƒ…å ±ç™ºä¿¡ã€è¦³å…‰æ¡ˆå†…ã®å¼·åŒ–ã€ç‹¬è‡ªã®ã‚µãƒ¼ãƒ“ã‚¹å·®åˆ¥åŒ–ã€‚;

             MAGI-7 (EMPATHY) å…±æ„Ÿãƒ»äººè„ˆ
            analysis.empathy = å¸¸é€£å®¢ã¨ã®é–¢ä¿‚æ€§æ§‹ç¯‰ãŒé‡è¦ã€‚é¡§å®¢ã®ãƒ‹ãƒ¼ã‚ºã‚’èãã€æ¬¡å›ä»¥é™ã®ç¹‹ãŒã‚Šã‚’ä½œã‚‹ã€‚;

             MAGI-8 (REALIST) ç¾å®Ÿãƒ»å®Ÿå‹™
            analysis.realist = ç¾åœ¨åœ°ã‹ã‚‰æœ€å¯„ã‚Šã®é«˜éœ€è¦ã‚¨ãƒªã‚¢ã‚’ç¢ºèªã€‚ã‚¬ã‚½ãƒªãƒ³ä»£ã‚„æ™‚é–“ã‚’è€ƒæ…®ã—ãŸå®Ÿè·µçš„ãªç§»å‹•ã‚’ã€‚;

             MAGI-9 (CARE) è‡ªå·±è‚¯å®š
            analysis.care = ä»Šæ—¥ã®åŠªåŠ›ã‚’è©•ä¾¡ã€‚${todayTotal.toLocaleString()}å††ç¨¼ã„ã ã“ã¨ã¯ç¢ºã‹ãªæˆæœã€‚ç„¦ã‚‰ãšç€å®Ÿã«ã€‚;

             MAGI-10 (REBEL) æŒ‘ç™ºãƒ»é€†å¼µ
            analysis.rebel = ä»–ã®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ãŒé¿ã‘ã‚‹æ™‚é–“å¸¯ã‚„ã‚¨ãƒªã‚¢ã«ã“ããƒãƒ£ãƒ³ã‚¹ã‚ã‚Šã€‚é€†å¼µã‚Šã®ç™ºæƒ³ã§ã€‚;

             MAGI-11 (META) ä¿¯ç°ãƒ»èª¿åœ
            analysis.meta = æ•°å€¤ç›®æ¨™ã¨é¡§å®¢æº€è¶³åº¦ã€å®‰å…¨é‹è»¢ã®ãƒãƒ©ãƒ³ã‚¹ã‚’è€ƒæ…®ã€‚æŒç¶šå¯èƒ½ãªå–¶æ¥­ã‚¹ã‚¿ã‚¤ãƒ«ã®ç¢ºç«‹ãŒæœ€é‡è¦ã€‚;

             åˆ¤å®šçµæœ
            let approval = [];
            let opposition = [];
            let conditional = [];

            if (achievementRate = 80) {
                approval = [LOGIC, DESIRE, FUTURE];
                conditional = [MORAL, REALIST];
                opposition = [];
            } else if (achievementRate = 50) {
                approval = [CREATE, EMPATHY, REBEL];
                conditional = [LOGIC, REALIST];
                opposition = [];
            } else {
                approval = [CREATE, REBEL];
                conditional = [LOGIC, FUTURE, REALIST];
                opposition = [];
            }

             æœ€çµ‚æ±ºè­°
            let result, summary;
            if (achievementRate = 100) {
                result = æ‰¿èª;
                summary = ç›®æ¨™é”æˆã€‚è¿½åŠ åå…¥ã‚’ç‹™ã„ã¤ã¤ã€æ¬¡å›ä»¥é™ã®å‚è€ƒãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã€‚;
            } else if (achievementRate = 80) {
                result = æ¡ä»¶ä»˜ãæ‰¿èª;
                summary = ç›®æ¨™é”æˆç›®å‰ã€‚åŠ¹ç‡çš„ãªå–¶æ¥­ç¶™ç¶šã‚’æ¨å¥¨ã€‚å®‰å…¨ã¨åŠ¹ç‡ã®ãƒãƒ©ãƒ³ã‚¹ã‚’ã€‚;
            } else if (achievementRate = 50) {
                result = æ¡ä»¶ä»˜ãæ‰¿èª;
                summary = æˆ¦ç•¥çš„ãªè¦‹ç›´ã—å¿…è¦ã€‚é«˜å˜ä¾¡ã‚¨ãƒªã‚¢ã¸ã®ç§»å‹•ã¨æ–°è¦é¡§å®¢é–‹æ‹“ã‚’ã€‚;
            } else {
                result = å†å¯©è­°è¦æ±‚;
                summary = æ ¹æœ¬çš„ãªæˆ¦ç•¥å¤‰æ›´ã‚’æ¤œè¨ã€‚æ™‚é–“å¸¯ã€ã‚¨ãƒªã‚¢ã€å–¶æ¥­ã‚¹ã‚¿ã‚¤ãƒ«ã®è¦‹ç›´ã—ã‚’ã€‚;
            }

            return {
                results analysis,
                decision {
                    approval approval,
                    opposition opposition,
                    conditional conditional,
                    result result,
                    summary summary
                }
            };
        }

         å£²ä¸Šè¨˜éŒ²
        document.getElementById('revenueForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const time = document.getElementById('time').value;
            const amount = parseInt(document.getElementById('amount').value);
            const memo = document.getElementById('memo').value;
            const dayOfWeek = document.getElementById('dayOfWeek').value;
            const date = new Date().toLocaleDateString('ja-JP');
            const isLongCustomer = document.getElementById('isLongCustomer').checked;
            
            const record = {
                id Date.now(),
                date date,
                time time,
                amount amount,
                memo memo,
                dayOfWeek dayOfWeek,
                isLongCustomer isLongCustomer,
                timestamp new Date().toISOString()
            };
            
            revenueData.push(record);
            localStorage.setItem('taxiRevenue', JSON.stringify(revenueData));
            
             ãƒ­ãƒ³ã‚°å®¢ã®å ´åˆã€è©³ç´°æƒ…å ±ã‚‚ä¿å­˜
            if (isLongCustomer) {
                const longCustomerRecord = {
                    id record.id,
                    date date,
                    time time,
                    dayOfWeek dayOfWeek,
                    amount amount,
                    pickupLocation document.getElementById('pickupLocation').value,
                    dropoffLocation document.getElementById('dropoffLocation').value,
                    customerType document.getElementById('customerType').value,
                    distance parseInt(document.getElementById('distance').value)  0,
                    memo memo
                };
                longCustomerData.push(longCustomerRecord);
                localStorage.setItem('longCustomerData', JSON.stringify(longCustomerData));
            }
            
             MAGIåˆ†æå®Ÿè¡Œ
            const todayTotal = revenueData
                .filter(r = r.date === date)
                .reduce((sum, r) = sum + r.amount, 0);
            
            const todayLongCustomers = longCustomerData
                .filter(r = r.date === date);
            
            const magiAnalysis = performMAGiAnalysis(record, todayTotal, targetAmount, todayLongCustomers);
            displayMAGiResults(magiAnalysis);
            
             ãƒ•ã‚©ãƒ¼ãƒ ã‚¯ãƒªã‚¢
            this.reset();
            document.getElementById('longCustomerDetails').classList.add('hidden');
            document.getElementById('isLongCustomer').checked = false;
            
             ç¾åœ¨æ™‚åˆ»ã‚’å†è¨­å®š
            const now = new Date();
            document.getElementById('time').value = now.toTimeString().slice(0, 5);
            
             è¡¨ç¤ºæ›´æ–°
            updateDisplay();
            updateChart();
        });

         MAGIçµæœè¡¨ç¤º
        function displayMAGiResults(analysis) {
            const resultsDiv = document.getElementById('magiResults');
            const analysisDiv = document.getElementById('magiAnalysis');
            
            resultsDiv.innerHTML = `
                div class=space-y-3
                    div class=p-3 bg-blue-50 rounded-lg
                        span class=font-semibold text-blue-700ğŸ”µ MAGI-1 (LOGIC)span
                        span class=ml-2${analysis.results.logic}span
                    div
                    div class=p-3 bg-yellow-50 rounded-lg
                        span class=font-semibold text-yellow-700ğŸŸ¡ MAGI-2 (MORAL)span
                        span class=ml-2${analysis.results.moral}span
                    div
                    div class=p-3 bg-red-50 rounded-lg
                        span class=font-semibold text-red-700ğŸ”´ MAGI-3 (DESIRE)span
                        span class=ml-2${analysis.results.desire}span
                    div
                    div class=p-3 bg-purple-50 rounded-lg
                        span class=font-semibold text-purple-700ğŸŸ£ MAGI-4 (FUTURE)span
                        span class=ml-2${analysis.results.future}span
                    div
                    div class=p-3 bg-gray-50 rounded-lg
                        span class=font-semibold text-gray-700âš« MAGI-5 (CRITIC)span
                        span class=ml-2${analysis.results.critic}span
                    div
                    div class=p-3 bg-green-50 rounded-lg
                        span class=font-semibold text-green-700ğŸŸ¢ MAGI-6 (CREATE)span
                        span class=ml-2${analysis.results.create}span
                    div
                    div class=p-3 bg-cyan-50 rounded-lg
                        span class=font-semibold text-cyan-700ğŸ©µ MAGI-7 (EMPATHY)span
                        span class=ml-2${analysis.results.empathy}span
                    div
                    div class=p-3 bg-amber-50 rounded-lg
                        span class=font-semibold text-amber-700ğŸŸ¤ MAGI-8 (REALIST)span
                        span class=ml-2${analysis.results.realist}span
                    div
                    div class=p-3 bg-pink-50 rounded-lg
                        span class=font-semibold text-pink-700ğŸ©· MAGI-9 (CARE)span
                        span class=ml-2${analysis.results.care}span
                    div
                    div class=p-3 bg-white border rounded-lg
                        span class=font-semibold text-gray-700âšª MAGI-10 (REBEL)span
                        span class=ml-2${analysis.results.rebel}span
                    div
                div
                
                div class=mt-4 p-4 bg-indigo-50 rounded-lg border-2 border-indigo-200
                    span class=font-semibold text-indigo-700ğŸª MAGI-11 (META) ä¿¯ç°æ‰€è¦‹span
                    span class=ml-2${analysis.results.meta}span
                div
                
                div class=mt-4 p-4 bg-gray-100 rounded-lg
                    h4 class=font-bold text-gray-800 mb-2ã€åˆ¤å®šçµæœã€‘h4
                    pspan class=font-semiboldè³›æˆspan ${analysis.decision.approval.join(', ')}p
                    pspan class=font-semiboldåå¯¾span ${analysis.decision.opposition.join(', ')}p
                    pspan class=font-semiboldæ¡ä»¶ä»˜ãspan ${analysis.decision.conditional.join(', ')}p
                    
                    h4 class=font-bold text-gray-800 mt-3 mb-2ã€æœ€çµ‚æ±ºè­°ã€‘h4
                    pspan class=font-semiboldçµæœspan ${analysis.decision.result}p
                    pspan class=font-semiboldç·è©•span ${analysis.decision.summary}p
                div
            `;
            
            analysisDiv.classList.remove('hidden');
        }

         è¡¨ç¤ºæ›´æ–°
        function updateDisplay() {
            const today = new Date().toLocaleDateString('ja-JP');
            const todayRevenue = revenueData
                .filter(record = record.date === today)
                .reduce((sum, record) = sum + record.amount, 0);
            
            const todayLongCustomers = longCustomerData
                .filter(record = record.date === today);
            
            document.getElementById('targetAmount').textContent = `Â¥${targetAmount.toLocaleString()}`;
            document.getElementById('currentRevenue').textContent = `Â¥${todayRevenue.toLocaleString()}`;
            document.getElementById('longCustomerCount').textContent = `${todayLongCustomers.length}ä»¶`;
            
            const achievementRate = Math.round((todayRevenue  targetAmount)  100);
            document.getElementById('achievementRate').textContent = `${achievementRate}%`;
            
             å£²ä¸Šä¸€è¦§æ›´æ–°
            updateRevenueList();
             ãƒ­ãƒ³ã‚°å®¢ä¸€è¦§æ›´æ–°
            updateLongCustomerList();
        }

         å£²ä¸Šä¸€è¦§æ›´æ–°
        function updateRevenueList() {
            const today = new Date().toLocaleDateString('ja-JP');
            const todayRecords = revenueData.filter(record = record.date === today);
            
            const listContainer = document.getElementById('revenueList');
            
            if (todayRecords.length === 0) {
                listContainer.innerHTML = 'p class=text-gray-500 text-center py-4å£²ä¸Šãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“p';
                return;
            }
            
            listContainer.innerHTML = todayRecords
                .sort((a, b) = a.time.localeCompare(b.time))
                .map(record = `
                    div class=flex justify-between items-center p-3 bg-gray-50 rounded-lg ${record.isLongCustomer  'border-l-4 border-purple-500'  ''}
                        div
                            span class=font-medium${record.time}span
                            span class=text-gray-600 ml-2(${record.dayOfWeek})span
                            ${record.memo  `span class=text-gray-600 ml-2- ${record.memo}span`  ''}
                            ${record.isLongCustomer  'span class=ml-2 px-2 py-1 bg-purple-100 text-purple-700 text-xs roundedãƒ­ãƒ³ã‚°å®¢span'  ''}
                        div
                        div class=flex items-center gap-2
                            span class=font-bold text-green-600Â¥${record.amount.toLocaleString()}span
                            button onclick=deleteRecord(${record.id}) class=text-red-500 hovertext-red-700 text-små‰Šé™¤button
                        div
                    div
                `).join('');
        }

         ãƒ­ãƒ³ã‚°å®¢ä¸€è¦§æ›´æ–°
        function updateLongCustomerList() {
            const listContainer = document.getElementById('longCustomerList');
            
            if (longCustomerData.length === 0) {
                listContainer.innerHTML = 'p class=text-gray-500 text-center py-4ãƒ­ãƒ³ã‚°å®¢ã®è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“p';
                return;
            }
            
             ç›´è¿‘ã®10ä»¶ã‚’è¡¨ç¤º
            const recentLongCustomers = longCustomerData
                .sort((a, b) = new Date(b.timestamp  b.date + ' ' + b.time) - new Date(a.timestamp  a.date + ' ' + a.time))
                .slice(0, 10);
            
            listContainer.innerHTML = recentLongCustomers
                .map(record = `
                    div class=p-3 bg-purple-50 rounded-lg border border-purple-200
                        div class=flex justify-between items-start mb-2
                            div
                                span class=font-medium${record.date} ${record.time}span
                                span class=text-purple-600 ml-2(${record.dayOfWeek})span
                            div
                            span class=font-bold text-purple-700Â¥${record.amount.toLocaleString()}span
                        div
                        div class=text-sm text-gray-600 space-y-1
                            pspan class=font-mediumçµŒè·¯span ${record.pickupLocation} â†’ ${record.dropoffLocation}p
                            pspan class=font-mediumè·é›¢span ${record.distance}kmp
                            pspan class=font-mediumå®¢å±¤span ${record.customerType}p
                            ${record.memo  `pspan class=font-mediumãƒ¡ãƒ¢span ${record.memo}p`  ''}
                        div
                    div
                `).join('');
        }

         ãƒ¬ã‚³ãƒ¼ãƒ‰å‰Šé™¤
        function deleteRecord(id) {
            if (confirm('ã“ã®å£²ä¸Šè¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                revenueData = revenueData.filter(record = record.id !== id);
                longCustomerData = longCustomerData.filter(record = record.id !== id);
                localStorage.setItem('taxiRevenue', JSON.stringify(revenueData));
                localStorage.setItem('longCustomerData', JSON.stringify(longCustomerData));
                updateDisplay();
                updateChart();
            }
        }

         é€±é–“ã‚°ãƒ©ãƒ•æ›´æ–°
        function updateChart() {
            const ctx = document.getElementById('weeklyChart').getContext('2d');
            
             éå»7æ—¥é–“ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
            const last7Days = [];
            const dailyRevenue = [];
            
            for (let i = 6; i = 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateStr = date.toLocaleDateString('ja-JP');
                const dayName = date.toLocaleDateString('ja-JP', { weekday 'short' });
                
                last7Days.push(dayName);
                
                const dayRevenue = revenueData
                    .filter(record = record.date === dateStr)
                    .reduce((sum, record) = sum + record.amount, 0);
                
                dailyRevenue.push(dayRevenue);
            }
            
             æ—¢å­˜ã®ãƒãƒ£ãƒ¼ãƒˆã‚’ç ´æ£„
            if (window.weeklyChart) {
                window.weeklyChart.destroy();
            }
            
            window.weeklyChart = new Chart(ctx, {
                type 'line',
                data {
                    labels last7Days,
                    datasets [{
                        label 'æ—¥æ¬¡å£²ä¸Š',
                        data dailyRevenue,
                        borderColor 'rgb(59, 130, 246)',
                        backgroundColor 'rgba(59, 130, 246, 0.1)',
                        tension 0.1
                    }, {
                        label 'ç›®æ¨™å£²ä¸Š',
                        data Array(7).fill(targetAmount),
                        borderColor 'rgb(239, 68, 68)',
                        borderDash [5, 5],
                        fill false
                    }]
                },
                options {
                    responsive true,
                    plugins {
                        legend {
                            position 'top',
                        },
                        title {
                            display true,
                            text 'é€±é–“å£²ä¸Šæ¨ç§»'
                        }
                    },
                    scales {
                        y {
                            beginAtZero true,
                            ticks {
                                callback function(value) {
                                    return 'Â¥' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

         ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        function exportData() {
            const exportData = {
                revenueData revenueData,
                longCustomerData longCustomerData,
                targetAmount targetAmount,
                exportDate new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], {type 'applicationjson'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `taxi-magi-data-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }

         ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢
        function clearData() {
            if (confirm('ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                localStorage.removeItem('taxiRevenue');
                localStorage.removeItem('longCustomerData');
                revenueData = [];
                longCustomerData = [];
                updateDisplay();
                updateChart();
                alert('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸã€‚');
            }
        }
    script
body
html